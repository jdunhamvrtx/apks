# Contributor: Trevor R.H. Clarke <trevor@notcows.com>
# Maintainer: Trevor R.H. Clarke <trevor@notcows.com>
pkgname=gdal
pkgver=2.2.1
pkgrel=1
pkgdesc="A translator library for raster and vector geospatial data formats"
url="http://gdal.org"
arch="x86_64"
license="MIT"
depends=""
depends_dev="gdal"
makedepends="giflib-dev jpeg-dev libjpeg-turbo-dev libpng-dev tiff-dev zlib-dev swig python2-dev linux-headers"
subpackages="$pkgname-dev py-$pkgname:py"
source="http://download.osgeo.org/$pkgname/$pkgver/$pkgname-$pkgver.tar.xz"
builddir="$srcdir/$pkgname-$pkgver"

build() {
	cd "$builddir"

	./configure --prefix=/usr || return 1
	make || return 1

	cd swig/python
	python2 setup.py build
}

package() {
	cd "$builddir"

	make DESTDIR="$pkgdir" install || return 1
	chmod -x "$pkgdir"/usr/include/*.h
}

py() {
	pkgdesc="$pkgname (python bindings)"

	cd "$builddir"/swig/python
	python2 setup.py install --prefix=/usr --root="$subpkgdir" || return 1

	chmod a+x scripts/*
	install -d "$subpkgdir"/usr/bin
	install -m755 scripts/*.py "$subpkgdir"/usr/bin/
}

md5sums="9441c41495d065d3ec8dd72211831cc7  gdal-2.2.1.tar.xz"
sha256sums="927098d54083ac919a497f787b835b099e9a194f2e5444dbff901f7426b86066  gdal-2.2.1.tar.xz"
sha512sums="59fe849dd16441c19aadce4b6e506b8411c6366752bb6a2a631a15379dadffb83acc45d961f83eb84eb7b922ebc3bfef87abf9de35f65b24e14d7bfd1e2e4cad  gdal-2.2.1.tar.xz"
