# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Notebook Gallery Team <team@nb.gallery>
pkgname=py3-numpy
_pkgname=numpy
pkgver=1.11.3
pkgrel=1
pkgdesc="Scientific tools for Python"
url="http://www.numpy.org"
arch="all"
license="BSD"
depends="gfortran"
depends_dev="python3-dev openblas-dev py3-nose cython3-dev py3-numpy"
makedepends="$depends_dev"
install=""
subpackages="$pkgname-dev $pkgname-doc"
source="$_pkgname-$pkgver.tar.gz::http://github.com/$_pkgname/$_pkgname/archive/v$pkgver.tar.gz
	$_pkgname-$pkgver-musl.patch
	site.cfg"

_builddir="$srcdir"/$_pkgname-$pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		site.cfg) msg $i; cp "$srcdir"/$i ./ || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	export ATLAS=None
	LDFLAGS="$LDFLAGS -shared"
	python3 setup.py build config_fc --fcompiler=gnu95  || return 1
}


package() {
	cd "$_builddir"
	python3 setup.py install  --prefix=/usr --root="$pkgdir" config_fc --fcompiler=gnu95  || return 1
	install -m755 -d "$pkgdir"/usr/share/licenses/custom/$pkgname
	install -m644 LICENSE.txt "$pkgdir"/usr/share/licenses/custom/$pkgname/LICENSE
}

md5sums="2025c9a18c836702a82262e1a04a3fbc  numpy-1.11.3.tar.gz
e15f9a4a6357a9d4c6a56ab2f6493557  numpy-1.11.3-musl.patch
6f15bb8fe3d12faa8983a9e18bbea2a9  site.cfg"
sha256sums="956afdeb9b5600e873326e410e9379684dac8f8f47ea569151a417984e7799cf  numpy-1.11.3.tar.gz
a01529c8e7b020b4617cea4a6b84799c7d0f9f62bad029a76fbe99f4877f9288  numpy-1.11.3-musl.patch
8aa71c1aec2a9fdf6ab6167c92e86bdaf27f9a263b6b9849097ec7dcdf6d91a3  site.cfg"
sha512sums="9383383b2b02ae71e248bc1ed41f0addfa9fc5f068da933e2717631228083fb504844c64d41a61e2722a63ab1e191a4c6764b664e75f00f720fdfd23d5ad40a9  numpy-1.11.3.tar.gz
e97c82762665cff50ea06ca0d8753f0bf12017668d0a006d2cd840c8aded5076082a6a7ffa7dba47e4d71a2dc71038f43198e25cd759978da3aec38f30fad633  numpy-1.11.3-musl.patch
21ca8db304cbbf5949f07702f2a42bb5e5a0d641921e36649555a41b0e48f04e96f53760417823177ac27f6de24b2191e6e1d5f0eb393beafa29f7484e23284f  site.cfg"
