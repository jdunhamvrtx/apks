# Contributor: Isaac Dunham <ibid.ag@gmail.com>
# Maintainer: Notebook Gallery Team <team@nb.gallery>
pkgname=py3-matplotlib
_pkgname=matplotlib
pkgver=2.0.0
pkgrel=1
pkgdesc="A Python library for plots"
url="http://matplotlib.org"
arch="all"
license="custom"
depends="python3 py3-numpy python3-tkinter py3-dateutil py3-parsing py3-tz py3-cycler"
makedepends="python3-dev gfortran py3-numpy-dev freetype-dev libpng-dev tk-dev"
subpackages="$pkgname-doc $pkgname-tests"
source="$_pkgname-$pkgver.tar.gz::https://github.com/matplotlib/$_pkgname/archive/v$pkgver.tar.gz setup.cfg"
builddir="$srcdir/$_pkgname-$pkgver"

build() {
        cp setup.cfg "$builddir"
	cd "$builddir"
	python3 setup.py build || return 1
}

package() {
	cd "$builddir"

	python3 setup.py install --prefix=/usr --root="$pkgdir" || return 1
	install -m755 -d "$pkgdir"/usr/share/licenses/custom/$pkgname
	install -m644 LICENSE/* "$pkgdir"/usr/share/licenses/custom/$pkgname/
}

tests() {
	pkgdesc="$pkgdesc (tests)"
	arch="noarch"
	depends="$depends py3-nose"
	local sitepath="$(python3 -c 'import site; print(site.getsitepackages()[0])')/$_pkgname"

	mkdir -p "$subpkgdir"$sitepath
	mv "$pkgdir"$sitepath/tests "$subpkgdir"$sitepath/
}

md5sums="560dc09ee76be68ee979e6c323064657  matplotlib-2.0.0.tar.gz
fa310c5eb92844b2cb765cce1a9b3132  setup.cfg"
sha256sums="966a0807bc961726a68e5b60b6e97c91eed6ba20e0d50dfd699a8f854b2d7370  matplotlib-2.0.0.tar.gz
a2926dfe7ac9700593d89a5112c83cddfa898cb00220f24b9799e597eda0d238  setup.cfg"
sha512sums="b0e6d91aee5f91e0155c9e6716eef1a7e1fb907daeb93d603709142b749878fd758e42fe3707ac73c3d87959c6a35126c9e17c08ef78c5734106fafdf198f304  matplotlib-2.0.0.tar.gz
a64173c2727ac59b5a3506dcca6f7e8ae5b2fb86404c964db5f6ff5214b518554bb8822c73dde4213ba1a99b99ce713de6f92706864d5b5f61df3456b423c3c7  setup.cfg"
