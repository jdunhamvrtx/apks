# Maintainer: Notebook Gallery Team <team@nb.gallery>
pkgname=hadoop
pkgver=2.6.5
pkgrel=0
pkgdesc="Apache Hadoop and Map/Reduce"
url="https://hadoop.apache.org"
arch="x86_64"
license="MIT"
depends="openjdk8"
depends_dev=""
makedepends=""
install=""
subpackages="$pkgname-dev $pkgname-doc"
package="$pkgname-$pkgver"
package_tar="$package.tar.gz"
source="http://apache.mirrors.tds.net/$pkgname/common/$pkgname-$pkgver/$pkgname-$pkgver.tar.gz"

builddir="$srcdir/$pkgname-$pkgver"

prepare() {
	cd $builddir

	# Move .txt files so they get put into the -doc subpackage
	mkdir -p share/licenses/$pkgname
	mv LICENSE.txt NOTICE.txt share/licenses/$pkgname
	mv README.txt share/doc/$pkgname

	# Clean up
	# TODO: Identify more files to remove
	find . -name "*sources.jar" -exec rm {} \;

	# TODO: Patch spark jar with alpine snappy .so
}

build() {
	# This just installs the binaries, so nothing to build
	return 0
}

package() {
	mkdir -p $pkgdir/usr
	cd $builddir
	cp -r $builddir/* $pkgdir/usr
}

md5sums="967c24f3c15fcdd058f34923e92ce8ac  hadoop-2.6.5.tar.gz"
sha256sums="001ad18d4b6d0fe542b15ddadba2d092bc97df1c4d2d797381c8d12887691898  hadoop-2.6.5.tar.gz"
sha512sums="fd9d24155bb18475c25bc6a88284a696224d5ef38503c5c3f1d4c0b65ae1c552d90d2136ca0fa45294d62204eed3d1154785c12cc260cca42ea2fbf027b461b2  hadoop-2.6.5.tar.gz"
